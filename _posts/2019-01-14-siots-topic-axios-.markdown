---
layout: post
title: "2주차 topic - axios"
subtitle: "siots"
categories: siots
tags: topic
comments: true
---

# 2주차 TOPIC - axios

## 1. XMLHttpRequest (XHR)

브라우저가 가지고있는 객체이고 이 객체를 사용해 서버와 상호작용을 할 수 있다.

IE는 ActiveX 컴포넌트로 XHR 객체를 지원

그 외 브라우저는 기본적으로 XHR 객체를 지원

페이지 전체의 데이터를 새로 받아오지 않고도 특정 URL로부터 데이터를 받아올 수 있다. 이를 이용해 웹페이지는 사용자를 방해하지 않고도 페이지의 일부분만을 업데이트할 수 있다. => `Ajax 프로그래밍에 주로 사용된다.`

> XHR의 이벤트 기반 모델은 요즘의 Promise기반과 generator 기반의 비동기 프로그래밍 방식과 잘 맞지 않는다.

> 이 개체의 인스턴스를 만들고 요청을 보내서 사용할 수 있다. => Q. 인스턴스를 만들려면?

---

## 2. Ajax (Asynchronous Javascript and Xml)

### 1. Ajax란 ?

Ajax는 자바스크립트의 라이브러리 중 하나이며 Asynchronous Javascript and Xml (비동기식 자바스크립트와 xml)의 약자이다.

XHR 객체를 이용해서 전체 페이지를 새로 고치지 않고도 페이지의 일부만을 위한 데이터를 로드하는 기법

**Javascript를 사용한 비동기 통신, 클라이언트와 서버간에 XML 데이터를 주고받는 기술** 이라고 할 수 있다.

이 때 서버와는 다음과 같은 다양한 형태의 데이터를 주고받을 수 있다.

- JSON
- XML
- HTML
- 텍스트 파일 등

> 비동기 방식 : 웹페이지를 리로드하지 않고 데이터를 불러오는 방식.
> 페이지 리로드의 경우 전체 리소스를 다시 불러와야 하는데, 모든 데이터를 재요청할 경우 불필요한 리소스 낭비가 발생하게 되지만
> 비동기 방식을 이용할 경우 필요한 부분만 불러와 사용할 수 있으므로 낭비가 적다는 장점이 있다.

> `ajax로 요청을 보내라` = `자바스크립트로 요청을 보내라`

### 2. Ajax로 요청 보내기

ajax를 이용해서 요청을 보내는 방법은 아주 다양하다.

그 중 자주 쓰이는 것은 `axios` 와 `fetchAPI`가 있다.

### 3. Ajax의 장단점

#### 장점

1. 웹페이지의 속도 향상
1. 서버의 처리가 완료 될 때까지 기다리지 않고 처리가 가능하다.
1. 서버에서 Data만 전송하면 되므로 전체적인 코딩의 양이 줄어든다.
1. 기존 웹에서는 불가능했던 다양한 UI를 가능하게 해준다.
1. 웹 페이지 전체를 다시 로딩하지 않고도 웹 페이지의 일부분만을 갱신할 수 있다.
1. 웹 페이지가 로드된 후에 서버로 데이터 요청을 보낼 수 있다.
1. 웹 페이지가 로드된 후에 서버로부터 데이터를 받을 수 있다.
1. 백그라운드 영역에서 서버로 데이터를 보낼 수 있다.

#### 단점

1. 히스토리 관리가 안된다.(보안에 좀 더 신경을 써야한다.)
1. 연속으로 데이터를 요청하면 서버 부하가 증가할 수 있다.
1. XHR을 통해 통신을 하는 경우 사용자에게 아무른 진행 정보가 주어지지 않는다 => 그래서 아직 요청이 완료되지 않았는데 사용자가 페이지를 떠나거나 오작동할 우료가 발생하게 된다.(로딩 인디케이터를 사용하자!)

### 4. Ajax의 한계

ajax를 사용하면 여러 장점을 가지지만, ajax로도 다음과 같은 일들은 처리할 수 없다.

1. ajax는 클라이언트가 서버에 데이터를 요청하는 클라이언트 풀링 방식\* 을 사용하므로, 서버 푸시 방식의 실시간 서비스는 만들 수 없다.
1. ajax로는 바이너리 데이터\* 를 보내거나 받을 수 없다.
1. ajax 스크립트가 포함된 서버가 아닌 다른 서버로 ajax 요청을 보낼 수는 없다.
1. 클라이언트의 PC로 ajax의 요청을 보낼 수는 없다.

> - 클라이언트 풀링(client pooling) 방식 : 사용자가 직접 원하는 정보를 서버에게 요청하여 얻는 방식을 의미한다. 이에 반해 서버 푸시(server push) 방식이란 사용자가 요청하지 않아도 서버가 알아서 자동으로 특정 정보를 제공하는 것을 의미한다. 요즘 많이 사용되는 스마트폰에서 각종 앱이 보내는 푸시 알림이 서버푸시 방식의 대표적인 예이다.

> - 바이너리 데이터(binary data) : 이진파일. 2진수 데이터만으로 이루어진 파일(.exe, .dll, .zip과 같은 압축파일, .mp3, .mpg, .jpg 등의 멀티미디어 파일)

### 5. Ajax의 동작 원리

![ajax를 이용한 웹 응용 프로그램의 동작 원리](http://tcpschool.com/lectures/img_ajax_ajax_application.png)

① : 사용자에 의한 요청 이벤트가 발생합니다.

② : 요청 이벤트가 발생하면 이벤트 핸들러에 의해 자바스크립트가 호출됩니다.

③ : 자바스크립트는 XMLHttpRequest 객체를 사용하여 서버로 요청을 보냅니다. 이때 웹 브라우저는 요청을 보내고 나서, 서버의 응답을 기다릴 필요 없이 다른 작업을 처리할 수 있습니다.

④ : 서버는 전달받은 XMLHttpRequest 객체를 가지고 Ajax 요청을 처리합니다.

⑤와 ⑥ : 서버는 처리한 결과를 HTML, XML 또는 JSON 형태의 데이터로 웹 브라우저에 전달합니다. 이때 전달되는 응답은 새로운 페이지를 전부 보내는 것이 아니라 필요한 데이터만을 전달합니다.

⑦ : 서버로부터 전달받은 데이터를 가지고 웹 페이지의 일부분만을 갱신하는 자바스크립트를 호출합니다.

⑧ : 결과적으로 웹 페이지의 일부분만이 다시 로딩되어 표시됩니다.

![기존 웹 응용 프로그램의 동작 원리](http://tcpschool.com/lectures/img_ajax_other_application.png)

### 4. 참고링크

[Ajax란 무엇인가?](https://coding-factory.tistory.com/143)

---

## 3. HTTP request methods

기억해야 할 메소드 **CRUD** : Create, Read, Update, Delete

#### Create

새로운 자료를 등록하는 작업

- ★`POST` : 서버에 새로운 데이터를 등록. (게시물 등록)

#### Read

자료의 본문을 요청하는 작업

- ★`GET` : 서버에 데이터 요청. 데이터를 받기만 한다. (게시물 읽기)

#### Update

자료의 본문을 수정하는 작업

- ★`PUT` : 서버의 데이터를 교체할 때. (게시물 수정)
- ★`PATCH` : 리소스의 부분만을 수정하는 데 쓰인다.

#### Delete

자료를 삭제하는 작업

- ★`DELETE` : 데이터 삭제

#### 그 외 메소드

- `HEAD` : `GET` 메소드의 요청과 동일한 응답을 요구하지만, 응답 본문을 포함하지 않는다.
- `CONNECT` : 목적 리소스로 식별되는 서버로의 터널을 맺는다.
- `OPTIONS` : 목적 리소스의 통신을 설정하는 데 쓰인다.
- `TRACE` : 목적 리소스의 경로를 따라 메시지 loop-back 테스트를 한다.

#### 참고 링크

[HTTP 요청 메소드](https://developer.mozilla.org/ko/docs/Web/HTTP/Methods)

---

## 4. Axios

### 1. Axios ?

**Promise 기반**의 HTTP 통신 라이브러리

상대적으로 다른 HTTP 통신 라이브러리들에 비해 문서화가 잘 되어있고 API가 다양하다.

여러 편의기능(instance와 같이 설정을 재사용하거나 요청중인 연결을 취소하는 등)을 제공

TypeScript를 사용할 수 있다

> axios는 내부적으로 XMLHttpRequest를 사용하고 있는데 Service Worker 등의 최신 기술이 XMLHttpRequest를 지원하지 않으므로, Service Worker를 사용할 예정에 있는 프로젝트에서는 Axios 대신 Fetch API를 사용해야만 함

---

### 2. 설치 방법

CDN 방식과 NPM 방식 2가지가 있다.

#### CDN 방식

```js
<script src="https://unpkg.com/axios/dist/axios.min.js" />
```

#### NPM 방식

```bash
npm install axios
```

---

### 3. 추가 방법

컴포넌트 파일에 axios를 가져온다.

```js
import axios from "axios";
```

---

### 4. IE에서의 axios

_axios는 promise 기반이라고 했지요 ?_

`IE`는 promise가 지원되지 않기 때문에 `axios`를 사용할 수 없다. _충격적.._

`es6-promise` 패키지를 설치하여 해결할 수 있다.

#### 설치

```bash
npm install — save es6-promise
```

#### es6-promise 추가

```js
require(‘es6-promise’).polyfill();
```

---

### 5. axios 사용

`axios()` 메소드를 사용한다.

결과값은 `promise`를 반환한다.

`axios`는 반환된 응답을 `JSON`으로 변환시켜 주고, 자바스크립트에서 `data` 객체로 반환된다. => 반환된 데이터 구조 그대로 사용이 가능하다.

---
